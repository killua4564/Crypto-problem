from secret import FLAG

from Crypto.Random.random import randrange
from Crypto.Util.number import *

from gmpy2 import next_prime


def genkey():
    while True:
        p = 2
        while size(p) < 512:
            p *= getPrime(randrange(2, 12))
        if isPrime(p + 1):
            return p + 1

def genkey2():
    r = randrange(1 << 256, 1 << 512)
    r1 = int(next_prime(r))
    r2 = int(next_prime(3 * next_prime(r)))
    return r1, r2

if __name__ == '__main__':
    p, (q1, q2)= genkey(), genkey2()
    flag_enc = pow(bytes_to_long(FLAG.encode()), 0x08, p * q1 * q2)
    print(f'n = {p * q1 * q2}')
    print(f'flag = {flag_enc}')

# n = 6312081956800453242005635638775696371964331197711691305988524250934422670842847567082346294645531370392639640378977436738050267523930928141102947907752882864626516425205269860114372618107450666027047226378144718448153445336075442922378352142961490699548714369526861636120457642764187087553926315130595677178383932745637982421135800386302683921967207504042339093722486435093268055558828813962385642778695527840215136317793200395448508173372291064570886206707599207
# flag = 40703716922238297540974699152906010511890612406354554321348345564275909770839370181255432537072729838781177907418967403582860866069798802973013764506845205221657698180529839362192238438018905283361530343132208538330159562551776147601468923502275584050060893448700748017026813914966498333560220409016323632451159567209031828544075438228998490904439427553454962348431909003611866394844731435113150450902434285544059140901085386616766280166693387555517220827551804
